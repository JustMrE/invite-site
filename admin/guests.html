<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>–°–ø–∏—Å–æ–∫ –≥–æ—Å—Ç–µ–π</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark px-3">
      <a class="navbar-brand" href="#">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω—ã–µ</a>
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarNav"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-3">
          <li class="nav-item">
            <a class="nav-link active" href="create.html">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="guests.html">–°–ø–∏—Å–æ–∫ –≥–æ—Å—Ç–µ–π</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="invites.html">–°–ø–∏—Å–æ–∫ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π</a>
          </li>
        </ul>
      </div>
    </nav>

    <main class="container mt-4">
      <h2>üìã –°–ø–∏—Å–æ–∫ –≥–æ—Å—Ç–µ–π</h2>
      <table class="table table-striped">
        <thead>
          <tr>
            <th>–î–∞—Ç–∞</th>
            <th>–ò–º—è</th>
            <th>–¢–∏–ø</th>
            <th>–°—Ç–∞—Ç—É—Å</th>
          </tr>
        </thead>
        <tbody id="guestTableBody"></tbody>
      </table>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      const sheetUrl =
        "https://script.google.com/macros/s/AKfycbxfNTanfQH3eoCAoW4CErPmk6kh5BT5l3ZwMyJa9nnDxXFCCl6PwCJFKak8HXRQV9MxLg/exec";

      fetch(sheetUrl)
        .then((res) => res.json())
        .then((data) => {
          const tbody = document.getElementById("guestTableBody");
          data.forEach((row) => {
            const tr = document.createElement("tr");

            const type = row["Invite ID"] ? "–ò–º–µ–Ω–Ω–æ–π" : "–ù–µ–∏–º–µ–Ω–Ω–æ–π";
            const status =
              row["–°—Ç–∞—Ç—É—Å"] === "yes"
                ? "“ö–∞—Ç—ã—Å–∞–¥—ã"
                : row["–°—Ç–∞—Ç—É—Å"] === "no"
                ? "“ö–∞—Ç—ã—Å–ø–∞–π–¥—ã"
                : "–ñ–∞—É–∞–ø –∂–æ“õ";

            tr.innerHTML = `
            <td>${row["–î–∞—Ç–∞"]}</td>
            <td>${row["–ò–º—è"] || "‚Äî"}</td>
            <td>${type}</td>
            <td>${status}</td>
          `;
            tbody.appendChild(tr);
          });
        });
    </script>
  </body>
</html>
